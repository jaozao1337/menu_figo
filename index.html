<!DOCTYPE html><html lang="pt-BR" class=""><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Banquete Na N1 - Guia Culin√°rio v2.0</title>    <script src="https://cdn.tailwindcss.com"></script>    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>    <link rel="preconnect" href="https://fonts.googleapis.com">    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">        <script>        // L√≥gica de tema otimizada para ser executada antes da renderiza√ß√£o da p√°gina        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {            document.documentElement.classList.add('dark');        } else {            document.documentElement.classList.remove('dark');        }    </script>    <style>        :root {            --bg-light: #FDFCF8;            --bg-dark: #1a1a1a;            --text-light: #3d3731;            --text-dark: #e5e7eb;            --primary: #8c2d19; /* Vinho */            --secondary: #d4af37; /* Dourado */            --accent: #f3e9d2; /* Creme */        }        body {            font-family: 'Inter', sans-serif;            background-color: var(--bg-light);            color: var(--text-light);        }        .dark body {            background-color: var(--bg-dark);            color: var(--text-dark);        }        h1, h2, h3, h4, h5 {            font-family: 'Playfair Display', serif;        }        .tab-active {            border-bottom-color: var(--primary);            color: var(--primary);            font-weight: 700;        }        .dark .tab-active {            border-bottom-color: var(--secondary);            color: var(--secondary);        }        .tab-inactive {            border-bottom-color: transparent;            color: #78716C;        }        .dark .tab-inactive {            color: #9ca3af;        }        .chart-container {            position: relative;            width: 100%;            max-width: 450px;            margin-left: auto;            margin-right: auto;            height: 300px;            max-height: 400px;        }        @media (min-width: 768px) {            .chart-container {                height: 400px;            }        }        .timeline-item::before {            content: '';            position: absolute;            top: 1.5rem;            left: -0.5rem;            width: 1rem;            height: 1rem;            border-radius: 50%;            background-color: var(--accent);            border: 3px solid var(--primary);        }        .dark .timeline-item::before {            background-color: #4b5563;            border-color: var(--secondary);        }        .timeline-line {            position: absolute;            top: 1.5rem;            left: 0;            transform: translateX(-50%);            width: 2px;            height: 100%;            background-color: #e5e7eb;        }        .dark .timeline-line {            background-color: #4b5563;        }        .recipe-step-item input[type="checkbox"]:checked + label {            text-decoration: line-through;            color: #a1a1aa;        }        .dark .recipe-step-item input[type="checkbox"]:checked + label {            color: #6b7280;        }        .spinner {            border: 4px solid rgba(0, 0, 0, 0.1);            width: 24px;            height: 24px;            border-radius: 50%;            border-left-color: var(--primary);            animation: spin 1s ease infinite;        }        .dark .spinner {            border-left-color: var(--secondary);        }        @keyframes spin {            0% { transform: rotate(0deg); }            100% { transform: rotate(360deg); }        }        .recipe-content ul { list-style-type: disc; list-style-position: inside; padding-left: 1rem; }        .recipe-content ol { list-style-type: decimal; list-style-position: inside; padding-left: 1rem; }        .section-bg-contrast { background-color: #FBF9F3; }        .dark .section-bg-contrast { background-color: #212121; }        .accordion-trigger-bg { background-color: #FBF9F3; }        .dark .accordion-trigger-bg { background-color: #292929; }        .accordion-trigger-bg:hover { background-color: #F3E9D2; }        .dark .accordion-trigger-bg:hover { background-color: #313131; }        .card-bg { background-color: #ffffff; }        .dark .card-bg { background-color: #242424; }        .card-border { border-color: #f3e9d2; }        .dark .card-border { border-color: #4b5563; }        .text-main-title { color: var(--primary); }        .dark .text-main-title { color: var(--secondary); }        .text-subtitle { color: #44403c; }        .dark .text-subtitle { color: #d1d5db; }        .text-section-title { color: var(--primary); }        .dark .text-section-title { color: var(--secondary); }        .text-body { color: #44403c; }        .dark .text-body { color: #d1d5db; }        .text-muted { color: #78716c; }        .dark .text-muted { color: #9ca3af; }        .sticky-nav { position: -webkit-sticky; position: sticky; top: 6rem; align-self: flex-start; }                .accordion-content {            max-height: 0;            overflow: hidden;            transition: max-height 0.5s ease-in-out;        }        .accordion-content.open {            max-height: 2000px; /* A height larger than any possible content */        }    </style></head><body class="antialiased transition-colors duration-500">    <div class="container mx-auto p-4 md:p-8 max-w-7xl">        <!-- Header -->        <header class="text-center mb-8 md:mb-12 relative">            <h1 class="text-4xl md:text-6xl font-bold text-main-title">Banquete Na N1</h1>            <p class="text-lg md:text-xl text-subtitle mt-2">Menu Interativo v2.0 By: Jo√£o Solagna</p>            <button id="theme-toggle" type="button" aria-label="Alternar modo de cor" class="absolute top-0 right-0 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5">                <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>                <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>            </button>        </header>        <!-- Navigation Tabs -->        <nav class="flex flex-wrap justify-center border-b border-stone-300 dark:border-gray-700 mb-8 sticky top-0 bg-opacity-80 backdrop-blur-sm z-10 bg-inherit">            <button data-tab="visao-geral" class="tab-btn tab-active text-sm md:text-base py-3 px-4 md:px-6 border-b-2 transition-colors duration-300">Vis√£o Geral</button>            <button data-tab="receitas" class="tab-btn tab-inactive text-sm md:text-base py-3 px-4 md:px-6 border-b-2 transition-colors duration-300">Receitas</button>            <button data-tab="planejamento" class="tab-btn tab-inactive text-sm md:text-base py-3 px-4 md:px-6 border-b-2 transition-colors duration-300">Planeamento</button>            <button data-tab="execucao" class="tab-btn tab-inactive text-sm md:text-base py-3 px-4 md:px-6 border-b-2 transition-colors duration-300">Execu√ß√£o</button>            <button data-tab="finalizacao" class="tab-btn tab-inactive text-sm md:text-base py-3 px-4 md:px-6 border-b-2 transition-colors duration-300">Finaliza√ß√£o</button>        </nav>        <!-- Content Sections -->        <main>            <!-- Vis√£o Geral Section -->            <section id="visao-geral" class="tab-content p-4 md:p-6 rounded-lg">                <div class="card-bg p-6 md:p-8 rounded-lg shadow-lg border card-border">                    <h2 class="text-3xl md:text-4xl font-bold mb-4 text-section-title">Uma Nova Sinfonia de Sabores</h2>                    <p class="text-base md:text-lg leading-relaxed text-body">                        Esta nova vers√£o do menu √© uma reorquestra√ß√£o que explora uma paleta de sabores mais robusta e ousada. O perfil de sabor agora se constr√≥i sobre a do√ßura concentrada dos figos em calda, em contraponto direto com o car√°ter salgado e penetrante das am√™ndoas defumadas. A harmonia √© reconstru√≠da sobre novos pilares: a do√ßura intensa do figo estabelece um contraste dram√°tico com a pung√™ncia do Gorgonzola, enquanto o aroma defumado das am√™ndoas forja uma alian√ßa poderosa com o lombo su√≠no, unindo o acompanhamento √† prote√≠na principal.                    </p>                </div>                <div class="grid md:grid-cols-3 gap-6 mt-8">                    <div class="card-bg p-6 rounded-lg border card-border hover:shadow-xl transition-shadow duration-300">                        <h3 class="text-2xl font-bold mb-2 text-subtitle">Lombo Su√≠no Assado</h3>                        <p class="text-muted">A base robusta e suculenta, com uma crosta perfeitamente dourada que dialoga com os sabores defumados.</p>                    </div>                    <div class="card-bg p-6 rounded-lg border card-border hover:shadow-xl transition-shadow duration-300">                        <h3 class="text-2xl font-bold mb-2 text-subtitle">Risoto de Figo em Calda</h3>                        <p class="text-muted">Um equil√≠brio audacioso entre a do√ßura concentrada do figo em calda e o salgado intenso do queijo Gorgonzola.</p>                    </div>                    <div class="card-bg p-6 rounded-lg border card-border hover:shadow-xl transition-shadow duration-300">                        <h3 class="text-2xl font-bold mb-2 text-subtitle">Farofa de Am√™ndoas Defumadas</h3>                        <p class="text-muted">A textura que surpreende, com a croc√¢ncia e o sabor profundo das am√™ndoas defumadas e castanhas.</p>                    </div>                </div>            </section>                        <!-- Receitas Section -->            <section id="receitas" class="tab-content hidden p-4 md:p-6 rounded-lg section-bg-contrast">                <h2 class="text-3xl md:text-4xl font-bold mb-6 text-section-title text-center">Receitas Detalhadas</h2>                <p class="text-center text-muted mb-8 max-w-2xl mx-auto">Clique no t√≠tulo de uma receita para expandir os seus detalhes. Marque os passos conclu√≠dos para acompanhar o seu progresso.</p>                <div id="recipe-accordion-container" class="space-y-2 max-w-4xl mx-auto">                    <!-- Recipe accordion will be generated here -->                </div>            </section>            <!-- Planeamento Section -->            <section id="planejamento" class="tab-content hidden p-4 md:p-6 rounded-lg">                <div class="grid lg:grid-cols-5 gap-8">                    <div class="lg:col-span-3">                        <h2 class="text-3xl font-bold mb-4 text-section-title">Lista de Compras Estrat√©gica</h2>                        <p class="text-muted mb-6">Use esta lista interativa para organizar as suas compras. O menu ao lado acompanha a sua rolagem.</p>                        <div id="shopping-list-container" class="space-y-4"></div>                    </div>                    <div class="lg:col-span-2">                         <div class="sticky-nav">                             <h3 class="text-xl font-bold mb-4 text-section-title">Navegar na Lista</h3>                             <div id="shopping-list-nav" class="space-y-2"></div>                             <h2 class="text-3xl font-bold mb-4 mt-8 text-section-title">Or√ßamento e IA</h2>                             <div class="card-bg p-4 md:p-6 rounded-lg border card-border mb-6 shadow-lg">                                <div class="chart-container">                                    <canvas id="budgetChart"></canvas>                                </div>                                <div id="budget-summary" class="mt-4 text-center"></div>                             </div>                             <div class="card-bg p-6 rounded-lg border card-border shadow-lg">                                <h3 class="text-2xl font-bold mb-4 text-subtitle">Assistente de Substitui√ß√µes</h3>                                <p class="text-muted mb-4">Faltou um ingrediente? Digite o nome e a IA encontrar√° a melhor alternativa.</p>                                <div class="flex flex-col sm:flex-row gap-2">                                    <input type="text" id="substitute-ingredient" placeholder="Ex: Am√™ndoa defumada" class="flex-grow p-2 border rounded-md focus:ring-amber-500 focus:border-amber-500 bg-white text-black placeholder-zinc-500 dark:bg-zinc-800 dark:text-white dark:placeholder-zinc-400 border-zinc-300 dark:border-zinc-600">                                    <button id="get-substitute-btn" class="bg-amber-600 text-white px-4 py-2 rounded-md hover:bg-amber-700 transition-colors flex items-center justify-center gap-2">                                        <span class="btn-text">‚ú® Encontrar</span>                                        <div class="spinner hidden"></div>                                    </button>                                </div>                                <div id="substitute-result" class="mt-4 text-gray-800 dark:text-gray-200 bg-stone-50 dark:bg-gray-700 p-4 rounded-md border card-border min-h-[100px]">                                    <p class="text-muted">As sugest√µes de substitui√ß√£o aparecer√£o aqui.</p>                                </div>                            </div>                         </div>                    </div>                </div>            </section>            <!-- Execu√ß√£o Section -->            <section id="execucao" class="tab-content hidden p-4 md:p-6 rounded-lg section-bg-contrast">                <div class="text-center">                    <h2 class="text-3xl md:text-4xl font-bold mb-2 text-section-title">Linha do Tempo da Execu√ß√£o</h2>                    <p class="text-muted mb-6">Siga a linha do tempo para uma execu√ß√£o perfeita.</p>                    <div class="flex justify-center space-x-2 my-8">                        <button data-filter="all" class="timeline-filter-btn px-4 py-2 rounded-full border">Tudo</button>                        <button data-filter="prep" class="timeline-filter-btn px-4 py-2 rounded-full border">Preparo Antecipado</button>                        <button data-filter="final" class="timeline-filter-btn px-4 py-2 rounded-full border">Execu√ß√£o Final</button>                    </div>                </div>                <div class="relative pl-8 max-w-3xl mx-auto">                    <div class="timeline-line"></div>                    <div id="timeline-container" class="space-y-8"></div>                </div>                <div class="card-bg p-6 rounded-lg border card-border shadow-lg mt-12 max-w-3xl mx-auto">                    <h3 class="text-2xl font-bold mb-4 text-subtitle">SOS do Chef</h3>                    <p class="text-muted mb-4">Algo correu mal? Descreva o problema e a nossa IA ir√° ajudar a salvar o seu prato.</p>                    <div class="flex flex-col sm:flex-row gap-2">                        <input type="text" id="troubleshooting-problem" placeholder="Ex: O meu risoto est√° muito doce" class="flex-grow p-2 border rounded-md focus:ring-amber-500 focus:border-amber-500 bg-white text-black placeholder-zinc-500 dark:bg-zinc-800 dark:text-white dark:placeholder-zinc-400 border-zinc-300 dark:border-zinc-600">                        <button id="get-troubleshooting-btn" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors flex items-center justify-center gap-2">                            <span class="btn-text">‚ú® Socorro!</span>                            <div class="spinner hidden"></div>                        </button>                    </div>                    <div id="troubleshooting-result" class="mt-4 text-gray-800 dark:text-gray-200 bg-stone-50 dark:bg-gray-700 p-4 rounded-md border card-border min-h-[100px]">                        <p class="text-muted">As solu√ß√µes aparecer√£o aqui.</p>                    </div>                </div>            </section>            <!-- Finaliza√ß√£o e Dicas Section -->            <section id="finalizacao" class="tab-content hidden p-4 md:p-6 rounded-lg">                 <h2 class="text-3xl md:text-4xl font-bold mb-6 text-section-title">Finaliza√ß√£o e Dicas do Chef</h2>                 <div class="grid md:grid-cols-2 gap-8">                    <div class="card-bg p-6 rounded-lg border card-border shadow-lg">                        <h3 class="text-2xl font-bold mb-4 text-subtitle">A Arte do Empratamento (Reimaginada)</h3>                        <ul class="space-y-4 text-muted">                            <li class="flex items-start">                                <span class="text-amber-600 dark:text-amber-400 font-bold mr-3 mt-1">1.</span>                                <div><strong class="text-body">A Base do Risoto:</strong> Sirva o risoto num prato fundo. Bata suavemente na base do prato para que ele se espalhe numa "onda" perfeita.</div>                            </li>                             <li class="flex items-start">                                <span class="text-amber-600 dark:text-amber-400 font-bold mr-3 mt-1">2.</span>                                <div><strong class="text-body">O Lombo e a Farofa:</strong> Disponha 2-3 fatias de lombo sobrepostas ao lado do risoto. Polvilhe a farofa de am√™ndoas generosamente sobre a carne.</div>                            </li>                             <li class="flex items-start">                                <span class="text-amber-600 dark:text-amber-400 font-bold mr-3 mt-1">3.</span>                                <div><strong class="text-body">As Finaliza√ß√µes:</strong> Distribua os quartos de figo, espete a tuile de parmes√£o na vertical e finalize com um fio da redu√ß√£o de calda de figo (opcional).</div>                            </li>                        </ul>                    </div>                    <div class="card-bg p-6 rounded-lg border card-border shadow-lg">                        <h3 class="text-2xl font-bold mb-4 text-subtitle">Assistente de Harmoniza√ß√£o</h3>                        <p class="text-muted mb-4">Diga-me a sua prefer√™ncia (ex: "vinhos brancos", "cervejas") e eu darei sugest√µes personalizadas.</p>                        <div class="flex flex-col sm:flex-row gap-2">                            <input type="text" id="pairing-preference" placeholder="Qual a sua prefer√™ncia?" class="flex-grow p-2 border rounded-md focus:ring-amber-500 focus:border-amber-500 bg-white text-black placeholder-zinc-500 dark:bg-zinc-800 dark:text-white dark:placeholder-zinc-400 border-zinc-300 dark:border-zinc-600">                            <button id="get-pairing-btn" class="bg-amber-600 text-white px-4 py-2 rounded-md hover:bg-amber-700 transition-colors flex items-center justify-center gap-2">                                <span class="btn-text">‚ú® Sugerir</span>                                <div class="spinner hidden"></div>                            </button>                        </div>                        <div id="pairing-result" class="mt-4 text-gray-800 dark:text-gray-200 bg-stone-50 dark:bg-gray-700 p-4 rounded-md border card-border min-h-[100px]">                            <p class="text-muted">As suas sugest√µes personalizadas aparecer√£o aqui.</p>                        </div>                    </div>                 </div>                 <div class="mt-8 card-bg p-6 rounded-lg border card-border shadow-lg">                    <h3 class="text-2xl font-bold mb-4 text-subtitle">Partilhar a sua Obra-Prima</h3>                    <p class="text-muted mb-4">Gere uma legenda cativante para partilhar a sua cria√ß√£o nas redes sociais. Escolha o tom!</p>                    <div class="flex flex-col sm:flex-row gap-2">                        <select id="social-tone" class="flex-grow p-2 border rounded-md focus:ring-amber-500 focus:border-amber-500 bg-white text-black dark:bg-zinc-800 dark:text-white border-zinc-300 dark:border-zinc-600">                            <option value="elegante">Elegante</option>                            <option value="divertido">Divertido e Descontra√≠do</option>                            <option value="foodie">Para Foodies</option>                        </select>                        <button id="get-social-post-btn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2">                            <span class="btn-text">‚ú® Gerar Legenda</span>                            <div class="spinner hidden"></div>                        </button>                    </div>                    <div id="social-post-result" class="mt-4 text-gray-800 dark:text-gray-200 bg-stone-50 dark:bg-gray-700 p-4 rounded-md border card-border min-h-[100px]">                        <p class="text-muted">A sua legenda para as redes sociais aparecer√° aqui.</p>                    </div>                </div>                 <div class="mt-12 section-bg-contrast p-6 rounded-lg">                     <h3 class="text-2xl font-bold mb-4 text-center text-subtitle">Aprofundamento Culin√°rio</h3>                     <div id="accordion-container" class="space-y-2 max-w-3xl mx-auto">                        <!-- Accordion items will be inserted here -->                     </div>                 </div>            </section>        </main>    </div>    <script>        document.addEventListener('DOMContentLoaded', function () {                        // --- DATA v2.0 ---            const shoppingListData = [                { category: 'A√ßougue', items: ['Lombo su√≠no (pe√ßa √∫nica, temperada, ~2 kg)'] },                { category: 'Hortifr√∫ti', items: ['Cebola branca (~3)', 'Cebola roxa (~1)', 'Cenoura (~3)', 'Sals√£o / Aipo (1 talo)', 'Alho (2 cabe√ßas)', 'Lim√£o siciliano (1)', 'Lim√£o taiti (1)', 'Salsinha fresca (1 ma√ßo)', 'Tomilho fresco (1 ma√ßo)', 'Alecrim fresco (1 ma√ßo)'] },                { category: 'Latic√≠nios e Frios', items: ['Queijo Gorgonzola Dolce (250 g)', 'Queijo Parmes√£o (pe√ßa, 300 g)', 'Manteiga sem sal (2 tabletes de 200 g)'] },                { category: 'Mercearia e Gr√£os', items: ['Figo em calda (1 lata, ~400g drenado)', 'Arroz Arb√≥reo (500 g)', 'Farinha de mandioca flocada (tipo Biju, 500 g)', 'Am√™ndoa defumada (150 g)', 'Castanha-de-caju torrada (150 g)', 'Mel (bisnaga, ~250 g)', 'Vinho branco seco (750 ml)', 'Azeite de oliva extravirgem (500 ml)', 'Sal (fino e grosso)', 'Pimenta-do-reino em gr√£os', 'Folha de louro'] }            ];            const budgetData = {                labels: ['Mercearia', 'Latic√≠nios', 'Lombo', 'Castanhas/Nozes', 'Hortifr√∫ti'],                values: [151.23, 93.46, 50.00, 49.50, 32.53],                datasets: [{                    label: 'Custo Estimado por Categoria',                    data: [151.23, 93.46, 50.00, 49.50, 32.53],                    backgroundColor: ['#8c2d19', '#d4af37', '#f3e9d2', '#a16207', '#ca8a04'],                    borderColor: '#FDFCF8',                    borderWidth: 4,                    hoverOffset: 10                }]            };            const timelineSteps = [                { type: 'prep', timing: 'Dia Anterior', title: 'Preparar o Caldo de Legumes', description: 'Doure intensamente os legumes (cenoura, sals√£o, cebola) com azeite. Adicione alho, √°gua, ervas e cozinhe em fogo brando por 1h30. Coe e refrigere.', icon: 'ü•¨' },                { type: 'prep', timing: 'Dia Anterior', title: 'Preparar a Farofa de Am√™ndoas', description: 'Toste a farinha na manteiga. Separadamente, refogue cebola e alho, adicione castanha-de-caju. Fora do fogo, misture as am√™ndoas defumadas. Combine tudo e guarde.', icon: 'ü•ú' },                { type: 'prep', timing: 'Dia do Jantar (T-4h)', title: 'Mise en Place', description: 'Pique a cebola, rale os queijos, esfarele o gorgonzola, drene e corte os figos, separe a manteiga em cubos.', icon: 'üî™' },                { type: 'final', timing: 'T-90 min', title: 'Pr√©-aquecer o forno', description: 'Pr√©-aque√ßa o forno a 180¬∞C e retire o lombo da geladeira.', icon: 'üî•' },                { type: 'final', timing: 'T-75 min', title: 'Selar e Assar o Lombo', description: 'Seque bem a superf√≠cie do lombo. Sele todos os lados numa frigideira quente com azeite at√© formar uma crosta escura. Transfira para uma assadeira e leve ao forno.', icon: 'üç≥' },                { type: 'prep', timing: 'T-30 min', title: 'Preparar Tuiles de Parmes√£o', description: 'Numa frigideira antiaderente em fogo baixo, polvilhe discos finos de parmes√£o ralado. Deixe derreter e dourar. Vire por 30s. Deixe arrefecer para ficarem crocantes.', icon: 'üßÄ' },                { type: 'final', timing: 'T-30 min', title: 'Aquecer o Caldo', description: 'Coloque o caldo de legumes para aquecer em fogo baixo. Ele precisa estar quente para o risoto.', icon: 'üç≤' },                { type: 'final', timing: 'T-25 min', title: 'Iniciar o Risoto', description: 'Fa√ßa o soffritto com cebola e manteiga. Adicione os figos picados para criar a base de sabor. Toste o arroz (tostatura) e deglaceie com vinho branco.', icon: 'üçö' },                { type: 'final', timing: 'T-23 min', title: 'Cozinhar o Risoto (Cottura)', description: 'Adicione o caldo quente, uma concha por vez, mexendo constantemente por 15-18 minutos, at√© o arroz estar al dente.', icon: '‚è≥' },                { type: 'final', timing: 'T-10 min', title: 'Descansar o Lombo', description: 'Retire o lombo do forno (a 63¬∞C), cubra com alum√≠nio e deixe descansar por 10-15 minutos. Este passo √© inegoci√°vel.', icon: '‚è∞' },                { type: 'final', timing: 'T-2 min', title: 'Finalizar o Risoto (Mantecatura)', description: 'Fora do fogo, adicione manteiga gelada, gorgonzola e parmes√£o. Mexa vigorosamente. Prove e equilibre os sabores. Adicione os quartos de figo e raspas de lim√£o.', icon: '‚ú®' },                { type: 'final', timing: 'T-0 min', title: 'Montar e Servir', description: 'Fatie o lombo. Monte os pratos conforme as instru√ß√µes de empratamento e sirva imediatamente.', icon: 'üçΩÔ∏è' },            ];                        const accordionItems = [                { title: 'Equil√≠brio Doce-Salgado no Risoto', content: 'A troca do figo fresco pelo em calda altera a percep√ß√£o do sabor. A do√ßura da calda (sacarose) √© mais direta e intensa. A experi√™ncia come√ßa com o doce imediato do figo, que √© abruptamente cortado pelo sal pungente do Gorgonzola. A base de umami do parmes√£o amortece o contraste, e a acidez do vinho e do lim√£o "reseta" o paladar, transformando o prato num evento sensorial multi-est√°gio.' },                { title: 'Fuma√ßa e Umami: A Sinergia', content: 'A am√™ndoa defumada eleva a farofa a um integrador de sabores. Os compostos fen√≥licos da fuma√ßa (guaiacol, siringol) criam uma "ponte de sabor" natural para os compostos gerados na crosta do lombo pela Rea√ß√£o de Maillard. A farofa n√£o est√° mais apenas ao lado do lombo; ela se torna uma extens√£o de seu perfil de sabor.' },                { title: 'Ideias para Sobras', content: 'N√£o desperdice as sobras de risoto e lombo! Transforme-as em novos pratos. Clique no bot√£o para receber sugest√µes criativas.', isGemini: true, id: 'leftovers' }            ];                        const recipeDetailsData = [                {                    title: 'Caldo de Legumes Caseiro (A Base de Tudo)',                    hasChefTip: true,                    content: `                        <div class="recipe-content text-body space-y-4">                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Ingredientes:</h5>                                <ul class="space-y-1">                                    <li>3 cenouras m√©dias, grosseiramente picadas</li>                                    <li>2 talos de sals√£o, grosseiramente picados</li>                                    <li>2 cebolas brancas, grosseiramente picadas</li>                                    <li>1 cabe√ßa de alho, cortada ao meio horizontalmente</li>                                    <li>3 colheres de sopa de azeite de oliva extravirgem</li>                                    <li>3 litros de √°gua fria</li>                                    <li>1 bouquet garni (ramos de tomilho, alecrim, folhas de louro e talos de salsinha amarrados)</li>                                    <li>Gr√£os de pimenta-do-reino a gosto</li>                                    <li>Sal (usar com modera√ß√£o)</li>                                </ul>                            </div>                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Modo de Preparo:</h5>                                <ol class="space-y-3">                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Numa panela grande, aque√ßa o azeite e doure bem a cenoura, o sals√£o e a cebola (10-15 min).</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Adicione o alho e cozinhe por mais um minuto.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Despeje a √°gua fria, raspando o fundo da panela.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Adicione o bouquet garni e a pimenta. Ferva e reduza para fogo baixo.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Cozinhe lentamente por no m√≠nimo 1h30min.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Coe o caldo cuidadosamente, descartando os s√≥lidos.</label></li>                                </ol>                            </div>                        </div>`                },                {                    title: 'Lombo Su√≠no Assado',                    hasChefTip: true,                    content: `                        <div class="recipe-content text-body space-y-4">                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Ingredientes:</h5>                                <ul class="space-y-1">                                    <li>1 pe√ßa de lombo su√≠no (~2 kg), j√° temperada</li>                                    <li>2-3 colheres de sopa de azeite de oliva</li>                                    <li>Ramos de tomilho e alecrim frescos</li>                                    <li>4-5 dentes de alho, levemente amassados</li>                                    <li>Pimenta-do-reino mo√≠da na hora</li>                                </ul>                            </div>                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Modo de Preparo:</h5>                                <ol class="space-y-3">                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Retire o lombo da geladeira 40 minutos antes. Pr√©-aque√ßa o forno a 180¬∞C.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Seque a carne com papel toalha. Tempere com pimenta.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Numa frigideira quente com azeite, sele todos os lados do lombo at√© formar uma crosta escura.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Transfira para uma assadeira com as ervas e o alho.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Asse por 50-60 minutos, ou at√© um term√≥metro atingir 63¬∞C no centro.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Retire do forno, cubra com alum√≠nio e deixe descansar por 10-15 minutos.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Fatie contra a fibra da carne antes de servir.</label></li>                                </ol>                            </div>                        </div>`                },                {                    title: 'Risoto de Figo em Calda e Gorgonzola',                    hasChefTip: true,                    content: `                        <div class="recipe-content text-body space-y-4">                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Ingredientes (Revisados):</h5>                                <ul class="space-y-1">                                    <li>500g de arroz Arb√≥reo</li>                                    <li>~2L de caldo de legumes quente</li>                                    <li>200g de queijo Gorgonzola Dolce, esfarelado</li>                                    <li>1 lata de figos em calda, drenados (calda reservada)</li>                                    <li>100ml de vinho branco seco</li>                                    <li>1 cebola branca m√©dia, picada</li>                                    <li>100g de manteiga sem sal, gelada e em cubos</li>                                    <li>100g de queijo parmes√£o, ralado na hora</li>                                    <li>1 colher de sopa de mel (opcional)</li>                                    <li>Raspas de 1 lim√£o siciliano</li>                                    <li>Sal, pimenta-do-reino, azeite</li>                                </ul>                            </div>                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Modo de Preparo (Reestruturado):</h5>                                <ol class="space-y-3">                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>Soffritto & Base de Figo:</strong> Refogue a cebola na manteiga e azeite. Junte metade dos figos, picados, e amasse-os para criar uma base de sabor adocicada (3-4 min).</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>Tostatura:</strong> Aumente o fogo, adicione o arroz e toste-o por 2-3 minutos.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>Sfumato & Cottura:</strong> Deglaceie com o vinho. Ap√≥s evaporar, adicione o caldo quente, concha a concha, mexendo sempre por 15-18 minutos at√© o arroz estar al dente.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>Mantecatura & Equil√≠brio:</strong> Fora do fogo, adicione manteiga gelada, Gorgonzola e parmes√£o. Mexa vigorosamente. Prove. Se necess√°rio, ajuste com mel. Incorpore o resto dos figos (em quartos) e as raspas de lim√£o.</label></li>                                </ol>                            </div>                        </div>`                },                {                    title: 'Farofa de Am√™ndoas Defumadas',                    hasChefTip: true,                    content: `                        <div class="recipe-content text-body space-y-4">                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Ingredientes:</h5>                                <ul class="space-y-1">                                    <li>500g de farinha de mandioca flocada (Biju)</li>                                    <li>150g de manteiga sem sal</li>                                    <li>150g de am√™ndoa defumada, picada</li>                                    <li>150g de castanha-de-caju torrada, picada</li>                                    <li>1 cebola roxa pequena, picada</li>                                    <li>2 dentes de alho picados</li>                                    <li>Salsinha fresca picada, sal, pimenta</li>                                </ul>                            </div>                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Modo de Preparo:</h5>                                <ol class="space-y-3">                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>Base Crocante:</strong> Numa frigideira, derreta 100g de manteiga e toste a farinha de mandioca por 10-15 min at√© dourar. Reserve.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>O Sabor:</strong> Na mesma frigideira, derreta 50g de manteiga, refogue a cebola e o alho. Toste a castanha-de-caju por 2-3 min.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label><strong>Combina√ß√£o:</strong> Desligue o fogo. Adicione as am√™ndoas defumadas √† frigideira (o calor residual √© suficiente). Misture tudo com a farinha reservada e a salsinha.</label></li>                                </ol>                            </div>                        </div>`                },                {                    title: 'Tuile de Parmes√£o (Vers√£o Intensificada)',                    hasChefTip: true,                    content: `                        <div class="recipe-content text-body space-y-4">                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Ingredientes:</h5>                                <ul class="space-y-1">                                    <li>150g de queijo Parmes√£o de boa qualidade, ralado finamente</li>                                </ul>                            </div>                            <div>                                <h5 class="text-lg font-semibold mb-2 text-subtitle">Modo de Preparo:</h5>                                <ol class="space-y-3">                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Aque√ßa uma frigideira antiaderente em fogo m√©dio-baixo.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Fa√ßa discos de parmes√£o ralado (8-10 cm). Cozinhe por 4-6 minutos, at√© as bordas dourarem.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Vire com uma esp√°tula e cozinhe por mais 30-45 segundos.</label></li>                                    <li class="recipe-step-item"><input type="checkbox" class="mr-2 accent-amber-500"><label>Retire e deixe arrefecer sobre papel toalha para ficarem crocantes.</label></li>                                </ol>                            </div>                        </div>`                }            ];            // --- Core Functions (No changes needed below this line) ---            const tabs = document.querySelectorAll('.tab-btn');            const contents = document.querySelectorAll('.tab-content');            tabs.forEach(tab => {                tab.addEventListener('click', () => {                    const target = tab.getAttribute('data-tab');                    tabs.forEach(t => t.classList.replace('tab-active', 'tab-inactive'));                    tab.classList.replace('tab-inactive', 'tab-active');                    contents.forEach(content => content.id === target ? content.classList.remove('hidden') : content.classList.add('hidden'));                });            });                        function renderShoppingList() {                const container = document.getElementById('shopping-list-container');                const navContainer = document.getElementById('shopping-list-nav');                container.innerHTML = '';                navContainer.innerHTML = '';                shoppingListData.forEach(category => {                    const categoryId = `category-${category.category.replace(/\s+/g, '-')}`;                    const categoryDiv = document.createElement('div');                    categoryDiv.innerHTML = `<h3 id="${categoryId}" class="text-xl font-bold text-subtitle mb-2 pt-4">${category.category}</h3>`;                    const ul = document.createElement('ul');                    ul.className = 'space-y-2';                    category.items.forEach(item => {                        const uniqueId = `item-${Math.random().toString(36).substr(2, 9)}`;                        const li = document.createElement('li');                        li.className = 'recipe-step-item';                        li.innerHTML = `<input type="checkbox" id="${uniqueId}" class="mr-2 accent-amber-500"><label for="${uniqueId}" class="text-body">${item}</label>`;                        ul.appendChild(li);                    });                    categoryDiv.appendChild(ul);                    container.appendChild(categoryDiv);                    const navLink = document.createElement('a');                    navLink.href = `#${categoryId}`;                    navLink.className = 'block text-muted hover:text-amber-600 dark:hover:text-amber-400 transition-colors';                    navLink.textContent = category.category;                    navContainer.appendChild(navLink);                });            }            function createBudgetChart() {                const ctx = document.getElementById('budgetChart').getContext('2d');                new Chart(ctx, {                    type: 'doughnut',                    data: budgetData,                    options: {                        responsive: true,                        maintainAspectRatio: false,                        plugins: {                            legend: { position: 'bottom', labels: { color: document.documentElement.classList.contains('dark') ? '#d1d5db' : '#44403c' } },                            tooltip: {                                callbacks: {                                    label: function(context) {                                        return `${context.label}: ${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(context.parsed)}`;                                    }                                }                            }                        }                    }                });                const total = budgetData.values.reduce((acc, val) => acc + val, 0);                const totalWithMargin = total * 1.10;                const summaryDiv = document.getElementById('budget-summary');                summaryDiv.innerHTML = `                    <p class="text-body">Custo Total: <span class="font-bold">${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(total)}</span></p>                    <p class="text-muted text-sm">Com margem de 10%: <span class="font-bold">${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalWithMargin)}</span></p>                `;            }                        function updateTimelineFilterButtons(activeFilter) {                 const filterButtons = document.querySelectorAll('.timeline-filter-btn');                 const activeClasses = ['bg-amber-600', 'text-white', 'border-transparent'];                 const inactiveClasses = ['bg-transparent', 'text-amber-600', 'dark:text-amber-300', 'border-amber-500', 'dark:border-amber-400'];                 filterButtons.forEach(button => {                    const filter = button.getAttribute('data-filter');                    button.classList.remove(...activeClasses, ...inactiveClasses);                    if (filter === activeFilter) {                        button.classList.add(...activeClasses);                    } else {                        button.classList.add(...inactiveClasses);                    }                 });            }            function renderTimeline(filter = 'all') {                const container = document.getElementById('timeline-container');                container.innerHTML = '';                const filteredSteps = timelineSteps.filter(step => filter === 'all' || step.type === filter);                                filteredSteps.forEach(step => {                    const stepDiv = document.createElement('div');                    stepDiv.className = 'timeline-item relative pl-8';                    const timingColor = step.type === 'prep' ? 'text-sky-600 dark:text-sky-400' : 'text-red-600 dark:text-red-400';                    const bgColor = 'card-bg';                    stepDiv.innerHTML = `                        <div class="p-4 rounded-lg border card-border shadow-lg flex items-center gap-4 ${bgColor}">                            <span class="text-2xl">${step.icon}</span>                            <div>                                <p class="font-bold ${timingColor} text-sm">${step.timing.toUpperCase()}</p>                                <h4 class="text-xl font-bold text-subtitle mt-1">${step.title}</h4>                                <p class="text-muted mt-2">${step.description}</p>                            </div>                        </div>                    `;                    container.appendChild(stepDiv);                });                updateTimelineFilterButtons(filter);            }            document.querySelectorAll('.timeline-filter-btn').forEach(button => {                button.addEventListener('click', (e) => {                    renderTimeline(e.currentTarget.getAttribute('data-filter'));                });            });                        function createGenericAccordion(containerId, items) {                const container = document.getElementById(containerId);                if (!container) return;                container.innerHTML = '';                                items.forEach((item, index) => {                    const itemDiv = document.createElement('div');                    itemDiv.className = 'border border-stone-300 dark:border-gray-700 rounded-lg overflow-hidden';                                        let contentHtml = item.content;                    if (item.isGemini) {                        contentHtml = `<p class="text-muted mb-4">${item.content}</p>                         <div class="mt-4">                            <button id="get-${item.id}-btn" class="bg-amber-600 text-white px-4 py-2 rounded-md hover:bg-amber-700 transition-colors flex items-center justify-center gap-2">                                <span class="btn-text">‚ú® Gerar Ideias</span>                                <div class="spinner hidden"></div>                            </button>                            <div id="${item.id}-result" class="mt-4 text-gray-800 dark:text-gray-200 bg-stone-50 dark:bg-gray-700 p-4 rounded-md border card-border min-h-[100px]">                                <p class="text-muted">As suas ideias criativas aparecer√£o aqui.</p>                            </div>                        </div>`;                    } else if (item.hasChefTip) {                        contentHtml += `                            <div class="mt-6 pt-4 border-t border-dashed border-stone-300 dark:border-gray-600">                                <button id="get-chef-tip-btn-${index}" data-recipe-title="${item.title}" class="bg-transparent border border-amber-600 text-amber-700 dark:border-amber-400 dark:text-amber-300 px-4 py-2 rounded-md hover:bg-amber-50 dark:hover:bg-amber-900/20 transition-colors flex items-center justify-center gap-2">                                    <span class="btn-text">‚ú® Dica do Chef</span>                                    <div class="spinner hidden"></div>                                </button>                                <div id="chef-tip-result-${index}" class="mt-4 text-amber-900 dark:text-amber-100 bg-amber-50/60 dark:bg-amber-900/20 p-4 rounded-md border border-amber-200 dark:border-amber-900/30 min-h-[75px] hidden">                                </div>                            </div>                        `;                    }                    itemDiv.innerHTML = `                        <h2>                            <button type="button" class="flex items-center justify-between w-full p-5 font-medium text-left text-subtitle accordion-trigger-bg transition-colors duration-200" data-accordion-trigger>                                <span class="text-xl font-bold">${item.title}</span>                                <svg class="w-4 h-4 shrink-0 transition-transform duration-300 text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>                            </button>                        </h2>                        <div class="accordion-content">                            <div class="p-5 border-t border-stone-300 dark:border-gray-700 card-bg">                                ${contentHtml}                            </div>                        </div>                    `;                    container.appendChild(itemDiv);                });                const triggers = container.querySelectorAll('[data-accordion-trigger]');                triggers.forEach(trigger => {                    trigger.addEventListener('click', function() {                        const content = this.parentElement.nextElementSibling;                        const wasOpen = content.classList.contains('open');                        container.querySelectorAll('.accordion-content.open').forEach(openContent => {                            if (openContent !== content) {                                openContent.classList.remove('open');                                openContent.previousElementSibling.querySelector('svg').classList.remove('rotate-180');                            }                        });                        content.classList.toggle('open');                        this.querySelector('svg').classList.toggle('rotate-180');                    });                });            }            // Gemini API Call Function            async function callGemini(prompt, button, resultContainer) {                const spinner = button.querySelector('.spinner');                const btnText = button.querySelector('.btn-text');                spinner.classList.remove('hidden');                btnText.classList.add('hidden');                button.disabled = true;                resultContainer.innerHTML = '<p class="text-muted">A gerar sugest√µes...</p>';                resultContainer.classList.remove('hidden');                                const apiKey = "AIzaSyB8DEuOcAad3AGQt-Yude4-B83l8ZFayzE"; // Canvas will provide the key                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };                const controller = new AbortController();                const timeoutId = setTimeout(() => controller.abort(), 30000);                try {                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload), signal: controller.signal });                    clearTimeout(timeoutId);                    if (!response.ok) {                        const errorBody = await response.json().catch(() => ({ error: { message: "N√£o foi poss√≠vel ler a resposta de erro da API." } }));                        throw new Error(`Falha na API (${response.status}) - ${errorBody.error.message}`);                    }                    const result = await response.json();                    let text = result?.candidates?.[0]?.content?.parts?.[0]?.text;                    if (text) {                        text = text.replace(/^```html\s*/, '').replace(/```$/, '');                        resultContainer.innerHTML = text;                    } else {                        throw new Error("A API retornou uma resposta inesperada.");                    }                } catch (error) {                    if (error.name === 'AbortError') {                        resultContainer.innerHTML = `<p class="text-red-500">A requisi√ß√£o demorou muito. Tente novamente.</p>`;                    } else {                        resultContainer.innerHTML = `<p class="text-red-500">Desculpe, ocorreu um erro: ${error.message}</p>`;                    }                } finally {                    spinner.classList.add('hidden');                    btnText.classList.remove('hidden');                    button.disabled = false;                }            }            // Setup Gemini Listeners            function setupGeminiButtonListeners() {                // Pairing Assistant                document.getElementById('get-pairing-btn')?.addEventListener('click', (e) => {                    const preference = document.getElementById('pairing-preference').value.trim() || 'qualquer uma';                    const prompt = `Voc√™ √© um sommelier. Para um menu de 'Risoto de figo em calda com gorgonzola e am√™ndoas defumadas' e 'Lombo su√≠no assado', o cliente tem a seguinte prefer√™ncia: '${preference}'. D√™ 2-3 sugest√µes de harmoniza√ß√£o. Explique cada escolha. A sua resposta DEVE conter APENAS o c√≥digo HTML, sem wrappers de markdown. Use <h4> para os t√≠tulos e <p> para as descri√ß√µes.`;                    callGemini(prompt, e.currentTarget, document.getElementById('pairing-result'));                });                // Leftovers Assistant                document.getElementById('get-leftovers-btn')?.addEventListener('click', (e) => {                    const prompt = `Voc√™ √© um chef criativo. Tenho sobras de 'risoto de figo em calda' e 'lombo su√≠no'. D√™ 3 ideias de pratos. A sua resposta DEVE conter APENAS o c√≥digo HTML. Use <h4> para o nome do prato e <p> para a descri√ß√£o.`;                    callGemini(prompt, e.currentTarget, document.getElementById('leftovers-result'));                });                // Substitute Assistant                document.getElementById('get-substitute-btn')?.addEventListener('click', (e) => {                    const ingredient = document.getElementById('substitute-ingredient').value;                    if (!ingredient) {                        document.getElementById('substitute-result').innerHTML = '<p class="text-red-500">Por favor, digite um ingrediente.</p>';                        return;                    }                    const prompt = `Voc√™ √© um chef experiente. Para um menu com 'lombo su√≠no' e 'risoto de figo em calda com am√™ndoas defumadas', preciso de substitui√ß√µes para: '${ingredient}'. D√™ 1 ou 2 alternativas pr√°ticas. Explique as implica√ß√µes. A sua resposta DEVE conter APENAS o c√≥digo HTML. Use <h4> para o substituto e <p> para a explica√ß√£o.`;                    callGemini(prompt, e.currentTarget, document.getElementById('substitute-result'));                });                // Chef Tips                recipeDetailsData.forEach((recipe, index) => {                    if (recipe.hasChefTip) {                        document.getElementById(`get-chef-tip-btn-${index}`)?.addEventListener('click', (e) => {                            const recipeTitle = e.currentTarget.getAttribute('data-recipe-title');                            const prompt = `Voc√™ √© um chef Michelin. D√™ uma dica profissional e n√£o √≥bvia para elevar a receita de '${recipeTitle}'. Foque em t√©cnica ou um ingrediente secreto. A sua resposta DEVE conter APENAS o c√≥digo HTML. Use um par√°grafo <p> conciso.`;                            callGemini(prompt, e.currentTarget, document.getElementById(`chef-tip-result-${index}`));                        });                    }                });                // Troubleshooting Assistant                document.getElementById('get-troubleshooting-btn')?.addEventListener('click', (e) => {                    const problem = document.getElementById('troubleshooting-problem').value.trim();                    if (!problem) {                        document.getElementById('troubleshooting-result').innerHTML = '<p class="text-red-500">Por favor, descreva o seu problema.</p>';                        return;                    }                    const prompt = `Voc√™ √© um mestre cozinheiro. Um cozinheiro tem um problema com 'Lombo Su√≠no e Risoto de Figo em Calda': '${problem}'. Forne√ßa instru√ß√µes claras para o resolver. Mantenha o tom encorajador. A sua resposta DEVE conter APENAS o c√≥digo HTML. Use <h4> para o t√≠tulo da solu√ß√£o e <p> para os passos.`;                    callGemini(prompt, e.currentTarget, document.getElementById('troubleshooting-result'));                });                // Social Media Post Generator                document.getElementById('get-social-post-btn')?.addEventListener('click', (e) => {                    const tone = document.getElementById('social-tone').value;                    const prompt = `Voc√™ √© um influenciador de comida. Gere uma legenda para o Instagram de uma foto de um 'Lombo Su√≠no com Risoto de Figo em Calda e Am√™ndoas Defumadas'. O tom √© '${tone}'. Inclua emojis e 3-5 hashtags. A sua resposta DEVE conter APENAS o c√≥digo HTML, formatado como uma √∫nica tag <p>.`;                    callGemini(prompt, e.currentTarget, document.getElementById('social-post-result'));                });            }            // Dark Mode Toggle            const themeToggleBtn = document.getElementById('theme-toggle');            const darkIcon = document.getElementById('theme-toggle-dark-icon');            const lightIcon = document.getElementById('theme-toggle-light-icon');                        function applyTheme() {                if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {                    document.documentElement.classList.add('dark');                    lightIcon.classList.remove('hidden');                    darkIcon.classList.add('hidden');                } else {                    document.documentElement.classList.remove('dark');                    darkIcon.classList.remove('hidden');                    lightIcon.classList.add('hidden');                }            }                        themeToggleBtn.addEventListener('click', function() {                const isDark = document.documentElement.classList.toggle('dark');                localStorage.setItem('color-theme', isDark ? 'dark' : 'light');                applyTheme();            });                        applyTheme();            // Initial Renders            renderShoppingList();            createBudgetChart();            renderTimeline();            createGenericAccordion('accordion-container', accordionItems);            createGenericAccordion('recipe-accordion-container', recipeDetailsData);            setupGeminiButtonListeners();        });    </script></body></html>